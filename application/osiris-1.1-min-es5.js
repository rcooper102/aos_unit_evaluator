"use strict";function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(n):s.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](t):t instanceof e}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var UtilsClass=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"getTransitionEvent",value:function(){if(this._transitionEvent)return this._transitionEvent;var t,e=document.createElement("fakeelement"),n={transition:{end:"transitionend",start:"transitionstart"},OTransition:{end:"oTransitionEnd",start:"oTransitionStart"},MozTransition:{end:"transitionend",start:"transitionstart"},WebkitTransition:{end:"webkitTransitionEnd",start:"webkitTransitionStart"}};for(t in n)if(void 0!==e.style[t])return this._transitionEvent=n[t],n[t]}},{key:"getStyle",value:function(t,e){t.get&&t.get();var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,"").getPropertyValue(e):t.currentStyle&&(e=e.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()}),n=t.currentStyle[e]),n}},{key:"cloneStyle",value:function(t,e){if(t.get&&(t=t.get()),e.get&&(e=e.get()),t.currentStyle){for(var n in t.style)if("string"==typeof t.style[n]){i=Data.cammelCaseToSentence(n,"-");if(""!=Utils.getStyle(t,i))try{e.style[n]=Utils.getStyle(t,i)}catch(t){}}}else for(var n in getComputedStyle(t,null))if("string"==typeof getComputedStyle(t,null)[n]){var i=Data.cammelCaseToSentence(n,"-"),s=getComputedStyle(t,null)[n];null!=Utils.getStyle(t,s)&&""!=Utils.getStyle(t,s)&&(e.style[Data.sentenceToCamelCase(s,"-").replace("-","")]=Utils.getStyle(t,s))}}},{key:"cloneObject",value:function(t){if("[object Array]"===Object.prototype.toString.call(t)){for(var e=[],n=0,i=t.length;n<i;n++)e[n]=arguments.callee(t[n]);return e}if("object"===_typeof(t)){e={};for(n in t)e[n]=arguments.callee(t[n]);return e}return t}},{key:"calculateDistance",value:function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}},{key:"getQueryVariable",value:function(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var i=e[n].split("=");if(i[0]==t)return unescape(i[1])}return""}},{key:"encodeQuery",value:function(t){var e="";for(var n in t)e+="".concat(""!==e?"&":"").concat(n,"=").concat(t[n]);return e}},{key:"isTouch",value:function(){var t=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/i),e=!!navigator.userAgent.match(/(iemobile)/i),n=navigator.userAgent.toLowerCase().indexOf("android")>-1;return!!(t||n||e)}},{key:"disableTouchScroll",value:function(){document.body.addEventListener("touchmove",Utils.onTouchScroll)}},{key:"enableTouchScroll",value:function(){document.body.removeEventListener("touchmove",Utils.onTouchScroll)}},{key:"onTouchScroll",value:function(t){t.preventDefault()}},{key:"hideMobileUrlBar",value:function(){setTimeout(function(){window.scrollTo(0,0)},0)}}]),t}(),Utils=new UtilsClass,BaseObject=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"wait",value:function(t){window.requestAnimationFrame(function(e){return t()})}}]),t}(),Events=new Object;function ConductorEvent(t,e,n,i,s){this.type=t,this.params=n,this.url=e,this.query=i,this.hash=s}function RouterEvent(t,e){this.type=t,this.target=e}function Event(t,e){this.type=t,this.target=e}function MouseEvent(t,e,n,i,s){this.type=t,this.target=e,this.delta=n,this.deltaX=i,this.deltaY=s}function KeyboardEvent(t,e){this.type=t,this.code=e,KeyboardEvent.index[e]&&(this.key=KeyboardEvent.index[e])}function TouchEvent(t,e,n){this.type=t,this.target=e,this.touches=n}Events.addKeyUpListener=function(t,e){t.addEventListener?t.addEventListener("keyup",e,!1):t.attachEvent&&t.attachEvent("onkeyup",e)},Events.addChangeListener=function(t,e){t.addEventListener?t.addEventListener("change",e,!1):t.attachEvent&&t.attachEvent("onchange",e)},Events.addFocusListener=function(t,e){t.addEventListener?t.addEventListener("focus",e,!1):t.attachEvent&&t.attachEvent("onfocus",e)},Events.addBlurListener=function(t,e){t.addEventListener?t.addEventListener("blur",e,!1):t.attachEvent&&t.attachEvent("onblur",e)},Events.intervalCallbacks=new Array,Events.addInterval=function(t){return Events.intervalCallbacks.push(t),1==Events.intervalCallbacks.length&&setInterval("Events.intervalFire();",10),Events.intervalCallbacks.length-1},Events.intervalFire=function(){for(var t=0;t<Events.intervalCallbacks.length;t++)""!=Events.intervalCallbacks[t]&&Events.intervalCallbacks[t]()},Events.removeInterval=function(t){Events.intervalCallbacks[t]=""},Events.mouseX=0,Events.mouseY=0,Events.enableMouseTracking=function(){},Events.disableMouseTracking=function(){},Events.addEvent=function(t,e,n){n.addEventListener?n.addEventListener(t,e,!1):n.attachEvent&&n.attachEvent("on"+t,e)},Events.removeEvent=function(t,e,n){n.removeEventListener?n.removeEventListener(t,e,!1):n.dettachEvent&&n.dettachEvent("on"+t,e)},ConductorEvent.LAUNCH="ConductorEvent.LAUNCH",ConductorEvent.NO_LAUNCH="ConductorEvent.NO_LAUNCH",ConductorEvent.DEFAULT="ConductorEvent.DEFAULT",ConductorEvent.ERROR="ConductorEvent.ERROR",RouterEvent.PAGE_CHANGE="RouterEvent.PAGE_CHANGE",RouterEvent.DEFAULT="RouterEvent.DEFAULT",RouterEvent.NOT_FOUND="RouterEvent.NOT_FOUND",Event.COMPLETE="Event.COMPLETE",Event.CANCEL="Event.CANCEL",Event.ACTIVATE="Event.ACTIVATE",Event.DEACTIVATE="Event.DEACTIVATE",Event.CLEAR="Event.CLEAR",Event.SHUTDOWN="Event.SHUTDOWN",Event.STARTUP="Event.STARTUP",Event.LOAD="Event.LOAD",Event.UNLOAD="Event.UNLOAD",Event.PROGRESS="Event.PROGRESS",Event.CHANGE="Event.CHANGE",Event.LOG_IN="Event.LOG_IN",Event.LOG_OUT="Event.LOG_OUT",Event.YES="Event.YES",Event.NO="Event.NO",Event.START="Event.START",Event.END="Event.END",Event.EDIT="Event.EDIT",Event.SAVE="Event.SAVE",Event.RELOAD="Event.RELOAD",Event.PAUSE="Event.PAUSE",Event.STOP="Event.STOP",Event.RESUME="Event.RESUME",Event.UPDATE="Event.UPDATE",Event.SUCCESS="Event.SUCCESS",Event.FAIL="Event.FAIL",Event.RESET="Event.RESET",Event.ADD="Event.ADD",Event.REMOVE="Event.REMOVE",Event.PREVIEW="Event.PREVIEW",MouseEvent.UP="MouseEvent.UP",MouseEvent.DOWN="MouseEvent.DOWN",MouseEvent.OVER="MouseEvent.OVER",MouseEvent.OUT="MouseEvent.OUT",MouseEvent.CLICK="MouseEvent.CLICK",MouseEvent.WHEEL="MouseEvent.WHEEL",MouseEvent.RIGHT_CLICK="MouseEvent.RIGHT_CLICK",MouseEvent.DRAG_START="MouseEvent.DRAG_START",MouseEvent.DRAG_END="MouseEvent.DRAG_END",MouseEvent.DRAG_OVER="MouseEvent.DRAG_OVER",MouseEvent.DRAG_OUT="MouseEvent.DRAG_OUT",MouseEvent.DRAG_DROP="MouseEvent.DRAG_DROP",MouseEvent.DRAGGED_DROP="MouseEvent.DRAGGED_DROP",MouseEvent.DRAGGED_OVER="MouseEvent.DRAGGED_OVER",MouseEvent.DRAGGED_OUT="MouseEvent.DRAGGED_OUT",MouseEvent.DRAG_MOVE="MouseEvent.DRAG_MOVE",MouseEvent.MOVE="MouseEvent.MOVE",KeyboardEvent.UP="KeyboardEvent.UP",KeyboardEvent.DOWN="KeyboardEvent.DOWN",KeyboardEvent.index={32:"space",8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl ",18:"alt",19:"pause/break",20:"caps lock",27:"escape",33:"page up",34:"page down",35:"end",36:"home",37:"left arrow",38:"up arrow",39:"right arrow",40:"down arrow",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"left window key",92:"right window key",93:"select key",96:"numpad 0",97:"numpad 1",98:"numpad 2",99:"numpad 3",100:"numpad 4",101:"numpad 5",102:"numpad 6",103:"numpad 7",104:"numpad 8",105:"numpad 9",106:"multiply",107:"add",109:"subtract",110:"decimal point",111:"divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"num lock",145:"scroll lock",186:"semi-colon",187:"equal sign",188:"comma",189:"dash",190:"period",191:"forward slash",192:"grave accent",219:"open bracket",220:"back slash",221:"close braket",222:"single quote"},TouchEvent.MOVE="TouchEvent.MOVE",TouchEvent.START="TouchEvent.START",TouchEvent.END="TouchEvent.END",TouchEvent.SWIPE_LEFT="TouchEvent.SWIPE_LEFT",TouchEvent.SWIPE_UP="TouchEvent.SWIPE_UP",TouchEvent.SWIPE_RIGHT="TouchEvent.SWIPE_RIGHT",TouchEvent.SWIPE_DOWN="TouchEvent.SWIPE_DOWN";var EventDispatcher=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).listenerLibrary=[],t.library=null,t}return _inherits(e,BaseObject),_createClass(e,[{key:"clearListeners",value:function(){this.listenerLibrary=new Array}},{key:"addListener",value:function(t,e,n){n||(console.error("EventDispatcher missing scope. Defaulting to 'this'"),n=this),null==this.listenerLibrary[t]&&(this.listenerLibrary[t]=new Array),this.listenerLibrary[t].push({method:e,scope:n})}},{key:"removeListener",value:function(t,e){if(this.listenerLibrary[t])for(var n=0;n<this.listenerLibrary[t].length;n++)this.listenerLibrary[t][n].method==e&&this.listenerLibrary[t].splice(n,1)}},{key:"dispatch",value:function(t){if(null!=this.listenerLibrary[t.type])for(var e in this.listenerLibrary[t.type])if(0==this.listenerLibrary[t.type][e].method.bind(this.listenerLibrary[t.type][e].scope)(t))return!1;return!0}}]),e}();function DOMEvent(t,e,n){this.type=t,this.target=e,this.delta=n}function WindowEvent(t,e,n){this.type=t,this.target=e,this.data=n}function DataEvent(t,e){this.type=t,this.data=e}function InputEvent(t,e){this.type=t,this.target=e}function FileEvent(t,e){this.type=t,this.files=e}function ErrorEvent(t,e,n){ErrorEvent.muted||console.error(e,n),this.type=t,this.target=n,this.text=e}function AjaxEvent(t,e,n,i,s){this.format=s,this.type=t,this.data=this.xml=e,this.ajaxConnect=i,this.ajax=i,this.status=n}function ValidationEvent(t,e,n){this.type=t,this.target=n,this.text=e}function TransitionEvent(t,e){this.type=t,this.target=e}DOMEvent.SCROLL="DOMEvent.SCROLL",WindowEvent.LOAD="WindowEvent.LOAD",WindowEvent.UNLOAD="WindowEvent.UNLOAD",WindowEvent.RESIZE="WindowEvent.RESIZE",WindowEvent.ERROR="WindowEvent.ERROR",WindowEvent.PULSE="WindowEvent.PULSE",WindowEvent.FRAME="WindowEvent.FRAME",DataEvent.COMPLETE="DataEvent.COMPLETE",DataEvent.LOAD="DataEvent.LOAD",DataEvent.PARSE="DataEvent.PARSE",DataEvent.ERROR="DataEvent.ERROR",InputEvent.CHANGE="InputEvent.CHANGE",InputEvent.FOCUS="InputEvent.FOCUS",InputEvent.BLUR="InputEvent.BLUR",InputEvent.KEY_UP="InputEvent.KEY_UP",InputEvent.KEY_DOWN="InputEvent.KEY_DOWN",FileEvent.OVER="FileEvent.OVER",FileEvent.OUT="FileEvent.OUT",FileEvent.DROP="FileEvent.DROP",ErrorEvent.ERROR="ErrorEvent.ERROR",ErrorEvent.muted=!1,AjaxEvent.COMPLETE="AjaxEvent.COMPLETE",AjaxEvent.RETURN="AjaxEvent.RETURN",AjaxEvent.SEND="AjaxEvent.SEND",AjaxEvent.PROGRESS="AjaxEvent.PROGRESS",AjaxEvent.ERROR="AjaxEvent.ERROR",ValidationEvent.VALID="ValidationEvent.VALID",ValidationEvent.INVALID="ValidationEvent.INVALID",ValidationEvent.INCOMPLETE="ValidationEvent.INCOMPLETE",ValidationEvent.MISSING="ValidationEvent.MISSING",ValidationEvent.WRONG="ValidationEvent.WRONG",ValidationEvent.RIGHT="ValidationEvent.RIGHT",ValidationEvent.WARNING="ValidationEvent.WARNING",ValidationEvent.ERROR="ValidationEvent.ERROR",ValidationEvent.OVERSIZE="ValidationEvent.OVERSIZE",ValidationEvent.UNDERSIZE="ValidationEvent.UNDERSIZE",TransitionEvent.COMPLETE="TransitionEvent.COMPLETE",TransitionEvent.BEGIN="TransitionEvent.BEGIN";var WindowClass=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).enterClosure=[],t.enterListener=!1,t.loadClosure=null,t.mouseX=0,t.mouseY=0,t.pulse=null,t._scrollBarWidth=0,Events.addEvent("load",function(e){return t.onLoad(e)},window),Events.addEvent("unload",function(e){return t.onUnLoad(e)},window),Events.addEvent("resize",function(e){return t.onResize(e)},window),Events.addEvent("error",function(e){return t.onError(e)},window),Events.addEvent("keyup",function(e){return t.onKeyUp(e)},window),Events.addEvent("keydown",function(e){return t.onKeyDown(e)},window),t.onFrame(null),t}return _inherits(e,EventDispatcher),_createClass(e,[{key:"onKeyUp",value:function(t){this.dispatch(new KeyboardEvent(KeyboardEvent.UP,t.keyCode)),null!=Window.enterClosure[String(t.keyCode)]&&Window.enterClosure[String(t.keyCode)]()}},{key:"onKeyDown",value:function(t){this.dispatch(new KeyboardEvent(KeyboardEvent.DOWN,t.keyCode))}},{key:"clearKey",value:function(t){this.enterClosure[String(t)]=null}},{key:"onLoad",value:function(){this.dispatch(new WindowEvent(WindowEvent.LOAD,this)),this.trackMouse()}},{key:"onUnLoad",value:function(){this.dispatch(new WindowEvent(WindowEvent.UNLOAD,this))}},{key:"onResize",value:function(){this.dispatch(new WindowEvent(WindowEvent.RESIZE,this))}},{key:"onError",value:function(t){this.dispatch(new WindowEvent(WindowEvent.ERROR,this,{message:t.message,file:t.url,line:t.line}))}},{key:"setTitle",value:function(t){document.title=t}},{key:"onFrame",value:function(t){var e=this;this.dispatch(new WindowEvent(WindowEvent.FRAME,this)),window.requestAnimationFrame(function(t){return e.onFrame(t)})}},{key:"trackMouse",value:function(t){this.removeListener(WindowEvent.LOAD,this.trackMouse),!!document.all||document.captureEvents(Event.MOUSEMOVE),document.onmousemove=this.onMouseMove.bind(this),document.touchmove&&(document.touchmove=this.onMouseMove.bind(this))}},{key:"onMouseMove",value:function(t){!!document.all?(this.mouseX=event.clientX+document.body.scrollLeft,this.mouseY=event.clientY+document.body.scrollTop):t.clientX?(this.mouseX=t.clientX,this.mouseY=t.clientY):(this.mouseX=t.pageX,this.mouseY=t.pageY),document.touchmove&&t.touches&&1==t.touches.length&&(this.mouseX=t.touches[0].pageX,this.mouseY=t.touches[0].pageY),this.mouseX<0&&(this.mouseX=0),this.mouseY<0&&(this.mouseY=0),Events.mouseX=this.mouseX,Events.mouseY=this.mouseY,this.dispatch(new MouseEvent(MouseEvent.MOVE,this))}},{key:"addListener",value:function(t,n,i){var s=this;if(_get(_getPrototypeOf(e.prototype),"addListener",this).call(this,t,n,i),this.listenerLibrary[t]&&1==this.listenerLibrary[t].length){if(t==WindowEvent.PULSE&&(this._onPulse||(this._onPulse=this.onPulse.bind(this)),this.pulse=Events.addInterval(function(t){return s._onPulse(t)})),t==MouseEvent.MOVE&&(this._onMouseMove||(this._onMouseMove=this.onMouseMove.bind(this)),Events.addEvent("mousemove",this._onMouseMove,document.documentElement)),t==MouseEvent.WHEEL){this._onMouseWheel||(this._onMouseWheel=this.onMouseWheel.bind(this));var o=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";Events.addEvent(o,this._onMouseWheel,document.documentElement)}t==DOMEvent.SCROLL&&(this._onScroll||(this._onScroll=this.onScroll.bind(this)),Events.addEvent("scroll",this._onScroll,document.documentElement))}}},{key:"onMouseWheel",value:function(t){var e=0,n=0,i=0;null!=t.deltaY?(i=t.deltaY/40*-1,t.deltaX&&(n=t.deltaX)):null!=t.wheelDelta?i=t.wheelDelta/120:null!=t.detail&&(i=-1*t.detail),i>=1?e=1:i<=-1&&(e=-1),this.dispatch(new MouseEvent(MouseEvent.WHEEL,this,e,n,i))}},{key:"onScroll",value:function(t){this.dispatch(new DOMEvent(DOMEvent.SCROLL),this)}},{key:"removeListener",value:function(t,n){if(_get(_getPrototypeOf(e.prototype),"removeListener",this).call(this,t,n),this.listenerLibrary[t]&&0==this.listenerLibrary[t].length){if(t==WindowEvent.PULSE&&Events.removeInterval(this.pulse),t==MouseEvent.MOVE&&Events.removeEvent("mousemove",this._onMouseMove,document.documentElement),t==MouseEvent.WHEEL){var i=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";Events.removeEvent(i,this._onMouseWheel,document.documentElement)}t==DOMEvent.SCROLL&&Events.removeEvent("scroll",this._onScroll,window)}}},{key:"onPulse",value:function(t){this.dispatch(new WindowEvent(WindowEvent.PULSE,this))}},{key:"deSelectAll",value:function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}},{key:"getObjectYPos",value:function(t){t.get&&(t=t.get());var e=0;if(t.offsetParent){do{e+=t.offsetTop}while(t=t.offsetParent);return Number([e])}}},{key:"getObjectXPos",value:function(t){t.get&&(t=t.get());var e=0;if(t.offsetParent){do{e+=t.offsetLeft}while(t=t.offsetParent);return Number([e])}}},{key:"scrollY",get:function(){return window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop}},{key:"scrollX",get:function(){return window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft}},{key:"scrollHeight",get:function(){return document.documentElement.scrollHeight||document.body.scrollHeight}},{key:"scrollWidth",get:function(){return document.documentElement.scrollWidth||document.body.scrollWidth}},{key:"width",get:function(){return void 0!==window.innerWidth?window.innerWidth:void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?document.documentElement.clientWidth:document.getElementsByTagName("body")[0].clientWidth}},{key:"height",get:function(){return void 0!==window.innerHeight?window.innerHeight:void 0!==document.documentElement&&void 0!==document.documentElement.clientHeight&&0!=document.documentElement.clientHeight?document.documentElement.clientHeight:document.getElementsByTagName("body")[0].clientHeight}},{key:"scrollBarWidth",get:function(){if(!this._scrollBarWidth){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;n==i&&(i=e.clientWidth),document.body.removeChild(e),this._scrollBarWidth=n-i}return this._scrollBarWidth}}]),e}(),Window=new WindowClass,Sound=function(){function t(){_classCallCheck(this,t),this.player=null,this.playing=!1}return _createClass(t,[{key:"play",value:function(t,e){this.playing&&this.stop(),this.playing=!0,this.player=new Embed,this.player.hidden(!0),this.player.autoStart(!0),this.player.loop(e),this.player.src(t),Body.addChild(this.player),this.player.get().style.visibility="hidden"}},{key:"stop",value:function(){this.playing&&(Body.removeChild(this.player),this.player=null,this.playing=!1)}}]),t}(),Cookies=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"set",value:function(t,e,n){var i=new Date;i.setDate(i.getDate()+n),document.cookie=t+"="+escape(e)+(null==n?"":";expires="+i.toUTCString())}},{key:"get",value:function(t){if(document.cookie.length>0){var e=document.cookie.indexOf(t+"=");if(-1!=e)return e=e+t.length+1,c_end=document.cookie.indexOf(";",e),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(e,c_end))}return""}}]),t}(),Strings=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"limit",value:function(t,e){return t.length>e&&(t=t.substr(0,e-3)+"..."),t}},{key:"capitalizeFirstLetter",value:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},{key:"convertLinks",value:function(t){return t=(t=t.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/i,"<a href='$1'>$1</a>")).replace(/([^\w])\@([\w\-]+)/gm,'$1<a href="http://twitter.com/$2" target="_blank">@$2</a>')}},{key:"trim",value:function(t){return t.replace(/^\s+|\s+$/g,"")}},{key:"stripHTML",value:function(t){t=t.replace("<br />","\\n");var e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText}}]),t}(),Data=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"cammelCaseToSentence",value:function(t,e){return(t=t.replace(/([A-Z])/g,e+"$1")).toLowerCase()}},{key:"sentenceToCamelCase",value:function(t,e){return(t=t.replace(e," ")).replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")}},{key:"parseNameValuePairs",value:function(t){for(var e=t.split("&"),n=new Array,i=0;i<e.length;i++){var s=e[i].split("=");n[s[0]]=s[1]}return n}},{key:"encodeNameValuePairs",value:function(t){var e="";for(var n in t)""!==e&&(e+="&"),e+=n+"="+t[n];return e}},{key:"stringToXML",value:function(t){return window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(t,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async="false",xmlDoc.loadXML(t)),xmlDoc}},{key:"xmlToString",value:function(t){return null==t.xml?(new XMLSerializer).serializeToString(t):t.xml}},{key:"compress",value:function(t){for(var e,n={},i=(t+"").split(""),s=[],o=i[0],r=256,a=1;a<i.length;a++)null!=n[o+(e=i[a])]?o+=e:(s.push(o.length>1?n[o]:o.charCodeAt(0)),n[o+e]=r,r++,o=e);s.push(o.length>1?n[o]:o.charCodeAt(0));for(a=0;a<s.length;a++)s[a]=String.fromCharCode(s[a]);return s.join("")}},{key:"deCompress",value:function(t){for(var e,n={},i=(t+"").split(""),s=i[0],o=s,r=[s],a=256,h=1;h<i.length;h++){var u=i[h].charCodeAt(0);e=u<256?i[h]:n[u]?n[u]:o+s,r.push(e),s=e.charAt(0),n[a]=o+s,a++,o=e}return r.join("")}}]),t}(),Social=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"twitter",value:function(t,e){e||(e=window.location),t?t+=" ":t="",(escape(t)+escape(e)).length>280&&console.error("Your tweet is too long. Twitter may truncate it."),window.open("http://twitter.com/home?status="+escape(t)+escape(e))}},{key:"facebook",value:function(t,e,n,i){t||(t=window.location);var s="http://www.facebook.com/sharer/sharer.php?s=100&p[url]="+escape(t).replace("%3A",":");e&&(s+="&p[title]="+escape(e)),n&&(s+="&p[summary]="+escape(n)),i&&(s+="&p[images][0]="+escape(i).replace("%3A",":")),window.open(s)}},{key:"pinterest",value:function(t,e,n){n||(n=window.location),e||(e=""),window.open("http://pinterest.com/pin/create/button/?media="+escape(t)+"&amp;description="+escape(e)+"&url="+escape(n))}},{key:"googlePlus",value:function(t){t||(t=window.location),window.open("https://plus.google.com/share?url="+escape(t))}}]),t}(),TextLoader=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,EventDispatcher),_createClass(e,[{key:"load",value:function(t){var e;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){return alert("You're browser does not support Text Loading, please update to the latest version of Firefox, Chrome, Safari, Internet Explorer, or Opera."),!1}}}e.open("GET",t,!0),e.onreadystatechange=function(){4==e.readyState&&(console.group("TextLoader: "+t),console.log(e.responseText),console.groupEnd(),this.dispatch(new DataEvent(DataEvent.LOAD,e.responseText)))},e.send({})}}]),e}(),Selector=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&e.obj&&(e=e.obj),this.objs=e?e.querySelectorAll(t):document.querySelectorAll(t),this.nodes=new Array;for(var n,i={anchor:Anchor,article:Article,aside:Aside,code:Code,details:Details,div:Div,embed:Embed,footer:Footer,form:Form,header:Header,iframe:IFrame,img:Img,input:Input,label:Label,link:Link,li:ListItem,nav:Nav,output:Output,p:Paragraph,progress:Progress,section:Section,source:Source,span:Span,summary:Summary,textarea:TextArea,ul:UnorderedList},s=0;s<this.objs.length;s++)if(this.objs[s]._obj)this.nodes.push(this.objs[s]._obj);else if(this.objs[s]&&this.objs[s].nodeName){for(var o in n=null,i)if(o==this.objs[s].nodeName.toLowerCase()){n=new i[o];break}null==n&&(n=new Base),n.obj=this.objs[s],this.nodes.push(n)}return this.nodes}}]),t}(),ScriptLoaderLoadedScripts=[],ScriptLoader=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).current=0,n.files=n.removeDuplicates(t),n.files.length>0?n.loadScript(n.current):setTimeout(function(t){return n.onComplete(t)},1),n}return _inherits(e,EventDispatcher),_createClass(e,[{key:"onComplete",value:function(t){this.dispatch(new Event(Event.PROGRESS,1)),this.dispatch(new Event(Event.COMPLETE))}},{key:"removeDuplicates",value:function(t){for(var e=[],n=0;n<t.length;n++)ScriptLoaderLoadedScripts[t[n]]||(ScriptLoaderLoadedScripts[t[n]]=!0,e.push(t[n]));return e}},{key:"loadScript",value:function(t){this.current=t;var e=this.files[this.current].split(".")[this.files[this.current].split(".").length-1];if("js"==e){var n=document.createElement("script");n.onload=this.onLoad.bind(this),n.src=this.files[this.current],Body.prependChild(n)}else if("css"==e){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=this.files[this.current],i.onload=this.onLoad.bind(this),Body.prependChild(i)}else this.dispatch(new ErrorEvent(ErrorEvent.ERROR,this.files[this.current]+" is not a currently supported file type. Loading it has been skipped.",this)),this.onLoad(null)}},{key:"onLoad",value:function(t){this.current==this.files.length-1?(this.dispatch(new Event(Event.PROGRESS,1)),this.dispatch(new Event(Event.COMPLETE))):(this.current++,this.dispatch(new Event(Event.PROGRESS,this.current/this.files.length)),this.loadScript(this.current))}}]),e}(),Thread=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).callback,t.interval,t.time,t.CONFIG=t.config={speed:1,callsPerTick:100},t.paused=!1,t.forCallback,t.forTotal,t}return _inherits(e,EventDispatcher),_createClass(e,[{key:"create",value:function(t){var e=this;this.interval?this.failedToCreate():(this.callback=t,this.time=0,this.interval=setInterval(function(t){return e.onTick(t)},this.CONFIG.speed))}},{key:"createFor",value:function(t,e){this.interval?this.failedToCreate():(this.forCallback=t,this.forTotal=e,this.create(this.onFor))}},{key:"failedToCreate",value:function(){console.error("Unable to create thread when one is already in progress")}},{key:"onFor",value:function(t){t<=this.forTotal&&this.forCallback(t),t==this.forTotal&&this.end()}},{key:"onTick",value:function(){for(var t=0;t<this.config.callsPerTick;t++)this.time++,this.callback(this.time),1e7==this.time&&console.warn("Thread has reached 10 million intervals.")}},{key:"pause",value:function(){this.paused||(clearInterval(this.interval),this.interval=null,this.paused=!0)}},{key:"resume",value:function(){this.paused&&(this.paused=!1,this.interval=setInterval(function(t){return onTick(t)},this.config.speed))}},{key:"end",value:function(){this.interval&&(this.paused=!1,clearInterval(this.interval),this.interval=null,this.dispatch(new Event(Event.COMPLETE,this)))}},{key:"getTime",value:function(){return this.time}}]),e}(),LocaleClass=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).locales=[],t._current=null,t.preloadQueue=[],t.preloaded=[],t}return _inherits(e,EventDispatcher),_createClass(e,[{key:"add",value:function(t,e){"string"!=typeof e?(this.locales[t]=e,this.current||(this.current=t)):console.error("Invalid locale data")}},{key:"gen",value:function(t,e,n){n||(n=this.current);var i=t;if(this.locales&&this.locales[n]&&this.locales[n][t]&&(i=this.locales[n][t],e))for(var s in e)i=i.replace("{["+s+"]}",e[s]);return i}},{key:"codes",value:function(){var t=[];for(var e in this.locales)t.push(e);return t}},{key:"has",value:function(t){return!!this.locales[i]}},{key:"preload",value:function(t){for(var e in t)null==this.preloaded[e]&&(this.preloadQueue.push({code:e,path:t[e]}),this.preloaded[e]=!1);this.preloadNext(null)}},{key:"preloadNext",value:function(){if(this.preloadQueue.length>0){var t=new TextLoader;t.addListener(DataEvent.LOAD,this.onPreload,this),t.load(this.preloadQueue[0].path)}else this.dispatch(new Event(Event.LOAD,this))}},{key:"onPreload",value:function(t){this.add(this.preloadQueue[0].code,JSON.parse(t.data)),this.preloadQueue.shift(),this.preloadNext()}},{key:"current",get:function(){return this._current},set:function(t){this._current!=t&&this.locales[t]&&(this._current=t,this.dispatch(new Event(Event.CHANGE,this)))}}]),e}(),Locale=new LocaleClass,Model=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)))._data=t||{},n}return _inherits(e,EventDispatcher),_createClass(e,[{key:"clone",value:function(){var t={};for(var n in this._data)t[n]=this._data[n];return new e(t)}},{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var n in t)this._data[n]=t[n];e||this.dispatch(new Event(Event.CHANGE,this))}},{key:"data",get:function(){return this._data}}]),e}(),ListModel=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)))._data=t||[],n._sorted=[],n._sort=null,n._filters=[],n._needsUpdate=!1,n}return _inherits(e,EventDispatcher),_createClass(e,[{key:"clone",value:function(){return new e(this._data.slice(0))}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.constructor!==Array&&(t=[t]);for(var n=0;n<t.length;n++)-1===this._data.indexOf(t[n])&&this._data.push(t[n]);this._needsUpdate=!0,e||this.dispatch(new Event(Event.CHANGE,this))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.constructor!==Array&&(t=[t]);for(var n=0;n<t.length;n++)-1!==this._data.indexOf(t[n])&&this._data.splice(this._data.indexOf(t[n]),1);this._needsUpdate=!0,e||this.dispatch(new Event(Event.CHANGE,this))}},{key:"addFilter",value:function(t){t.constructor!==Array&&(t=[t]);for(var e=0;e<t.length;e++)-1===this._filters.indexOf(t[e])&&this._filters.push(t[e]);this._needsUpdate=!0,this.dispatch(new Event(Event.CHANGE,this))}},{key:"removeFilter",value:function(t){t.constructor!==Array&&(t=[t]);for(var e=0;e<t.length;e++)-1!==this._filters.indexOf(t[e])&&this._filters.splice(this._filters.indexOf(t[e]),1);this._needsUpdate=!0,this.dispatch(new Event(Event.CHANGE,this))}},{key:"clearFilters",value:function(){this._filters=[],this._needsUpdate=!0,this.dispatch(new Event(Event.CHANGE,this))}},{key:"update",value:function(){this._needsUpdate=!1,this._sorted=[];for(var t=0;t<this._data.length;t++)if(0!==this._filters.length){for(var e=!0,n=0;n<this._filters.length;n++)if(!this._filters[n](this._data[t])){e=!1;break}e&&this._sorted.push(this._data[t])}else this._sorted.push(this._data[t]);this.sort&&this._sorted.sort(this.sort)}},{key:"raw",get:function(){return this._data}},{key:"data",get:function(){return this._needsUpdate&&this.update(),this._sorted}},{key:"filters",get:function(){return this._filters}},{key:"sort",set:function(t){this._sort=t,this._needsUpdate=!0,this.dispatch(new Event(Event.CHANGE,this))},get:function(){return this._sort}}]),e}(),BrainClass=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,Model),e}(),Brain=new BrainClass,ImageLoader=function(t){function e(t,n){var i;return _classCallCheck(this,e),(i=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)))._params=n,i._loaded=!1,i.image=new Image,i.image.onload=i.onLoad.bind(_assertThisInitialized(i)),i.image.src="".concat(t,"?").concat(Data.encodeNameValuePairs(n)),i}return _inherits(e,EventDispatcher),_createClass(e,[{key:"onLoad",value:function(t){this.image.onload=null,this._loaded=!0,this.dispatch(new Event(Event.LOAD,this))}},{key:"params",get:function(){return this._params}},{key:"src",get:function(){return this.image.src}},{key:"width",get:function(){return this.image.width||0}},{key:"height",get:function(){return this.image.height||0}},{key:"loaded",get:function(){return this._loaded}}]),e}(),GeometricShape=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).x=t.y=t.width=t.height=0,t}return _inherits(e,BaseObject),_createClass(e,[{key:"constrain",value:function(t){var e=this.getBounds();t.constrainWithin(e),this.x=e.x,this.y=e.y}},{key:"constrainWithin",value:function(t){t.x+t.width>this.x+this.width&&(t.x=this.x+this.width-t.width),t.y+t.height>this.y+this.height&&(t.y=this.y+this.height-t.height),t.x<this.x&&(t.x=this.x),t.y<this.y&&(t.y=this.y)}},{key:"distanceTo",value:function(t){return Utils.calculateDistance(new Point(this.x,this.y),new Point(t.x,t.y))}},{key:"bounds",get:function(){return new Rectangle(this.x,this.y,this.width,this.height)}},{key:"area",get:function(){return this.width*this.height}}]),e}(),Point=function(t){function e(t,n){var i;return _classCallCheck(this,e),(i=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).x=t,i.y=n,i.width=i.height=0,i}return _inherits(e,GeometricShape),e}(),Rectangle=function(t){function e(t,n,i,s){var o;return _classCallCheck(this,e),(o=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).x=t,o.y=n,o.width=i,o.height=s,o}return _inherits(e,GeometricShape),_createClass(e,[{key:"diagonalLength",get:function(){return Math.sqrt(this.width*this.width+this.height*this.height)}}]),e}(),Line=function(t){function e(t,n,i,s){var o;return _classCallCheck(this,e),(o=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).x=t,o.y=n,o.x2=i,o.y2=s,o.height=o.width=0,o}return _inherits(e,GeometricShape),_createClass(e,[{key:"constrainWithin",value:function(t){var e,n,i,s=this.x2-this.x,o=this.y2-this.y,r=new Point(0,0),a=new Point(t.x,t.y);for(i=0;i<=Math.abs(s);i++)r.y=o*(i/Math.abs(s)),r.x=s*(i/Math.abs(s)),n=Utils.calculateDistance(r,a),(!e||n<e)&&(e=n,t.y=r.y,t.x=r.x)}},{key:"length",get:function(){return Utils.calculateDistance(new Point(this.x,this.y),new Point(this.x2,this.y2))}},{key:"bounds",get:function(){var t,e,n,i;return this.x<this.x2?(t=this.x,n=this.x2-this.x):(t=this.x2,n=this.x-this.x2),this.y<this.y2?(e=this.y,i=this.y2-this.y):(e=this.y2,i=this.y-this.y2),new Rectangle(t,e,n,i)}}]),e}(),Ajax=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).connection,n.loadingPage,n._url=t,n._method=e.methods.POST,n._type=e.types.JSON,n._delayed=!1,n.cache,n}return _inherits(e,EventDispatcher),_createClass(e,null,[{key:"methods",get:function(){return{GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH",COPY:"COPY",HEAD:"HEAD",OPTIONS:"OPTIONS",LINK:"LINK",UNLINK:"UNLINK",PURGE:"PURGE",LOCK:"LOCK",UNLOCK:"UNLOCK",PROPFIND:"PROPFIND",VIEW:"VIEW"}}},{key:"types",get:function(){return{JSON:"application/json",URL:"application/x-www-form-urlencoded",TEXT:"text/plain",HTML:"text/html",XML:"text/xml"}}}]),_createClass(e,[{key:"connect",value:function(){try{this.connection=new XMLHttpRequest}catch(t){try{this.connection=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{this.connection=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){return console.log("AJAX not supported."),!1}}}}},{key:"send",value:function(t,n,i){var s,o=this;this.cache={data:t,query:n,file:i},null==this.connection&&this.connect(),this.method||(this.method=e.methods.GET),n&&(s=this.createURLString(n)),this.type==e.types.URL&&(t=this.createURLString(t)),this.type==e.types.JSON&&(t=JSON.stringify(t)),this.type==e.types.XML&&(t=window.ActiveXObject?xmlData.xml:(new XMLSerializer).serializeToString(t)),n?(""!=n&&(s="?"+s),this.connection.open(this.method,this.url+s,!0)):this.connection.open(this.method,this.url,!0),i?(this.connection.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.connection.setRequestHeader("X-FILENAME",i.name),this.connection.upload.addEventListener("progress",function(t){return o.onFileProgress(t)},!1),this.connection.send(i)):(this.connection.setRequestHeader("Content-type",this.type),this.connection.send(t)),this.connection.onreadystatechange=function(t){return o.onDataReturn(t)},Conductor.dispatch(new AjaxEvent(AjaxEvent.SEND,t,null,this))}},{key:"createURLString",value:function(t){var e="";if(t)if("string"==typeof t)e=t;else for(var n in t)""!=e&&(e+="&"),e+=n+"="+escape(String(t[n]));return e}},{key:"onFileProgress",value:function(t){this.dispatch(new AjaxEvent(AjaxEvent.PROGRESS,{bytesLoaded:t.loaded,bytesTotal:t.total},null,this,"JSON"))}},{key:"onDataReturn",value:function(t){if(4==this.connection.readyState){var e;try{e=JSON.parse(this.connection.responseText)}catch(t){e=this.connection.responseText}if(Conductor.dispatch(new AjaxEvent(AjaxEvent.RETURN,e,this.connection.status,this)),!this.delayed){var n=AjaxEvent.COMPLETE;200!=this.connection.status&&(n=AjaxEvent.ERROR),this.dispatch(new AjaxEvent(n,e,this.connection.status,this))}}}},{key:"delay",value:function(){this._delayed=!0}},{key:"reload",value:function(){this.cache&&(this._delayed=!1,this.send(this.cache.data,this.cache.query,this.cache.file))}},{key:"method",get:function(){return this._method},set:function(t){this._method=t}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}},{key:"url",get:function(){return this._url},set:function(t){this._url=t}},{key:"delayed",get:function(){return this._delayed}}]),e}(),FileUploader=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).api,t.list,t.current=-1,t.query,t.returns=[],t}return _inherits(e,EventDispatcher),_createClass(e,[{key:"send",value:function(t,e,n){this.api=e,this.query=n,this.list=t,this.uploadNext(null)}},{key:"uploadNext",value:function(t){if(this.current++,t&&this.returns.push(t),this.list[this.current]){var e=new Ajax(this.api);e.type=Ajax.types.URL,this.query.fileIndex=this.current+1,this.query.fileTotal=this.list.length,e.send(null,this.query,this.list[this.current]),e.addListener(AjaxEvent.COMPLETE,this.uploadNext,this),e.addListener(AjaxEvent.PROGRESS,this.onProgress,this)}else this.current++,this.onProgress(null),this.dispatch(new Event(Event.COMPLETE,this.returns))}},{key:"onProgress",value:function(t){for(var e,n,i=0,s=0,o=0;o<this.list.length;o++)s+=this.list[o].size,o<this.current?i+=this.list[o].size:o==this.current&&(i+=t.data.bytesLoaded);(isNaN(i)&&(i=0),t)?this.dispatch(new Event(Event.PROGRESS,(_defineProperty(e={dataUploaded:i,totalData:s,currentUploaded:t.data.bytesLoaded,currentTotal:t.data.bytesTotal,currentFile:this.list[this.current]},"currentFile",this.current),_defineProperty(e,"totalFiles",this.list.length),e))):this.dispatch(new Event(Event.PROGRESS,(_defineProperty(n={dataUploaded:i,totalData:s,currentUploaded:this.list[this.list.length-1].size,currentTotal:this.list[this.list.length-1].size,currentFile:this.list[this.list.length-1]},"currentFile",this.current),_defineProperty(n,"totalFiles",this.list.length),n)))}}]),e}(),FileBrowser=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).input,t}return _inherits(e,EventDispatcher),_createClass(e,[{key:"browse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.input=document.createElement("input"),this.input.type="file",t&&(this.input.multiple="true"),this.input.onchange=this.onSelect.bind(this),Body.addChild(this.input),this.input.style.display="none",this.input.click(),Body.removeChild(this.input)}},{key:"onSelect",value:function(t){if(this.dispatch(new Event(Event.CHANGE,t.target.files)),t.target.files&&t.target.files[0]){var e=new FileReader;e.onload=this.onPreview.bind(this),e.readAsDataURL(t.target.files[0])}}},{key:"onPreview",value:function(t){this.dispatch(new Event(Event.PREVIEW,t.target.result))}}]),e}();Element.wheelIndex=[];var Base=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)))._obj,t.dragTarget,t.dragClone,t.dragTick,t.currentDragX,t.currentDragY,t.dragTargets=new Array,t.dragging=!1,t.currentDragOver,t.mouseMove,t.mX,t.mY,t.dragBounds,t.dragRectangle,t._dropMouse=!0,t.dragX,t.dragY,t.startSwipeX,t.startSwipeY,t.swipeX,t.swipeY,t._swipeThreshold=30,t.swiping=!1,t.classes=new Array,t.touchClickBlock=!1,t._opacity,t._drag,t._tabIndex,t._width,t._height,t._x,t._y,t._z,t._scaleX,t._scaleY,t._rotation,t._skewX,t._skewY,t.clickDelay=1,t.clickEnabled=!0,t.suppressNativeMouse=!1,t}return _inherits(e,EventDispatcher),_createClass(e,[{key:"addClass",value:function(t){this.obj.classList.add(t)}},{key:"removeClass",value:function(t){this.obj.classList.remove(t)}},{key:"addChild",value:function(t){t.obj?this.obj.appendChild(t.obj):this.obj.appendChild(t)}},{key:"prependChild",value:function(t){this.obj.insertBefore(t,this.obj.firstChild)}},{key:"removeChild",value:function(t){t.obj?this.obj.removeChild(t.obj):this.obj.removeChild(t)}},{key:"assignElement",value:function(t){this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj),this.obj=t}},{key:"removeChildren",value:function(){this.obj.innerHTML=""}},{key:"make",value:function(t){this.obj=document.createElement(t)}},{key:"addClickListener",value:function(t){Events.addEvent("click",t,this.obj)}},{key:"onTouchClickStart",value:function(t){var e=this;this.touchClickBlock=!1,Events.addEvent("touchend",function(t){return e.touchClickEndEvent},this.obj),Events.addEvent("touchmove",function(t){return e.onTouchClickMove(t)},this.obj)}},{key:"onTouchClickEnd",value:function(t){this.touchClickBlock||this.onMouseClick(t)}},{key:"onTouchClickMove",value:function(t){this.touchClickBlock=!0}},{key:"removeClickListener",value:function(t){Events.removeEvent("click",t,this.obj),Events.removeEvent("touchend",t,this.obj)}},{key:"addMouseOverListener",value:function(t){Events.addEvent("mouseover",t,this.obj)}},{key:"removeMouseOverListener",value:function(t){Events.removeEvent("mouseover",t,this.obj)}},{key:"addMouseOutListener",value:function(t){Events.addEvent("mouseout",t,this.obj)}},{key:"removeMouseOutListener",value:function(t){Events.removeEvent("mouseout",t,this.obj)}},{key:"addMouseDownListener",value:function(t){Events.addEvent("mousedown",t,this.obj),Events.addEvent("touchstart",t,this.obj)}},{key:"removeMouseDownListener",value:function(t){Events.removeEvent("mousedown",t,this.obj),Events.removeEvent("touchstart",t,this.obj)}},{key:"addMouseUpListener",value:function(t){Events.addEvent("mouseup",t,this.obj),Events.addEvent("touchend",t,this.obj)}},{key:"addTransitionListener",value:function(t){Events.addEvent(Utils.getTransitionEvent().end,t,this.obj)}},{key:"addTransitionStartListener",value:function(t){Events.addEvent(Utils.getTransitionEvent().start,t,this.obj)}},{key:"removeMouseUpListener",value:function(t){Events.removeEvent("mouseup",t,this.obj),Events.removeEvent("touchend",t,this.obj)}},{key:"removeTransitionListener",value:function(t){Events.removeEvent(Utils.getTransitionEvent().end,t,this.obj)}},{key:"removeTransitionStartListener",value:function(t){Events.removeEvent(Utils.getTransitionEvent().start,t,this.obj)}},{key:"addRightClickListener",value:function(t){Events.addEvent("contextmenu",t,this.obj)}},{key:"removeRightClickListener",value:function(t){Events.removeEvent("contextmenu",t,this.obj)}},{key:"addScrollListener",value:function(t){Events.addEvent("scroll",t,this.obj)}},{key:"removeScrollListener",value:function(t){Events.removeEvent("scroll",t,this.obj)}},{key:"addWheelListener",value:function(t){var e=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";Events.addEvent(e,t,this.obj)}},{key:"removeWheelListener",value:function(t){var e=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";Events.removeEvent(e,t,this.obj)}},{key:"addFileOverListener",value:function(t){Events.addEvent("dragover",t,this.obj)}},{key:"addFileOutListener",value:function(t){Events.addEvent("dragleave",t,this.obj)}},{key:"addFileDropListener",value:function(t){Events.addEvent("drop",t,this.obj),this._onFileDropOverProxy||(this._onFileDropOverProxy=this.onFileDropOverProxy.bind(this)),Events.addEvent("dragover",this._onFileDropOverProxy,this.obj)}},{key:"removeFileOverListener",value:function(t){Events.removeEvent("dragover",t,this.obj)}},{key:"removeFileOutListener",value:function(t){Events.removeEvent("dragleave",t,this.obj)}},{key:"removeFileDropListener",value:function(t){Events.removeEvent("drop",t,this.obj),Events.removeEvent("dragover",this._onFileDropOverProxy,this.obj)}},{key:"addListener",value:function(t,n,i){_get(_getPrototypeOf(e.prototype),"addListener",this).call(this,t,n,i),this.listenerLibrary[t]&&1==this.listenerLibrary[t].length&&(t==TransitionEvent.COMPLETE&&(this._onTransitionComplete||(this._onTransitionComplete=this.onTransitionComplete.bind(this)),this.addTransitionListener(this._onTransitionComplete)),t==TransitionEvent.BEGIN&&(this._onTransitionBegin||(this._onTransitionBegin=this.onTransitionBegin.bind(this)),this.addTransitionStartListener(this._onTransitionBegin)),t==MouseEvent.UP&&(this._onMouseUp||(this._onMouseUp=this.onMouseUp.bind(this)),this.addMouseUpListener(this._onMouseUp)),t==MouseEvent.DOWN&&(this._onMouseDown||(this._onMouseDown=this.onMouseDown.bind(this)),this.addMouseDownListener(this._onMouseDown)),t==MouseEvent.CLICK&&(this._onMouseClick||(this._onMouseClick=this.onMouseClick.bind(this)),this.addClickListener(this._onMouseClick)),t==MouseEvent.OVER&&(this._onMouseOver||(this._onMouseOver=this.onMouseOver.bind(this)),this.addMouseOverListener(this._onMouseOver)),t==MouseEvent.OUT&&(this._onMouseOut||(this._onMouseOut=this.onMouseOut.bind(this)),this.addMouseOutListener(this._onMouseOut)),t==FileEvent.OVER&&(this._onFileOver||(this._onFileOver=this.onFileOver.bind(this)),this.addFileOverListener(this._onFileOver)),t==FileEvent.OUT&&(this._onFileOut||(this._onFileOut=this.onFileOut.bind(this)),this.addFileOutListener(this._onFileOut)),t==FileEvent.DROP&&(this._onFileDrop||(this._onFileDrop=this.onFileDrop.bind(this)),this.addFileDropListener(this._onFileDrop)),t==MouseEvent.RIGHT_CLICK&&(this._onRightClick||(this._onRightClick=this.onRightClick.bind(this)),this.addRightClickListener(this._onRightClick)),t==MouseEvent.WHEEL&&(e.wheelIndex.push(this.obj),this._onWheel||(this._onWheel=this.onWheel.bind(this)),this.addWheelListener(this._onWheel)),t==MouseEvent.MOVE&&(this._onMouseMove||(this._onMouseMove=this.onMouseMove.bind(this)),this.mouseMove=Events.addInterval(this._onMouseMove),Events.enableMouseTracking()),t==DOMEvent.SCROLL&&(this._onScroll||(this._onScroll=this.onScroll.bind(this)),this.addScrollListener(this._onScroll)),t==TouchEvent.MOVE&&(this._onTouchMove||(this._onTouchMove=this.onTouchMove.bind(this)),Events.addEvent("touchmove",this._onTouchMove,this.obj)),t==TouchEvent.START&&(this._onTouchStart||(this._onTouchStart=this.onTouchStart.bind(this)),Events.addEvent("touchstart",this._onTouchStart,this.obj)),t==TouchEvent.SWIPE_LEFT&&(this._onSwipeLeft||(this._onSwipeLeft=this.onSwipeLeft.bind(this)),this.addListener(TouchEvent.START,this._onSwipeLeft)),t==TouchEvent.SWIPE_RIGHT&&(this._onSwipeRight||(this._onSwipeRight=this.onSwipeRight.bind(this)),this.addListener(TouchEvent.START,this._onSwipeRight)),t==TouchEvent.SWIPE_UP&&(this._onSwipeUp||(this._onSwipeUp=this.onSwipeUp.bind(this)),this.addListener(TouchEvent.START,this._onSwipeUp)),t==TouchEvent.SWIPE_DOWN&&(this._onSwipeDown||(this._onSwipeDown=this.onSwipeDown.bind(this)),this.addListener(TouchEvent.START,this._onSwipeDown)),t==TouchEvent.END&&(this._onTouchEnd||(this._onTouchEnd=this.onTouchEnd.bind(this)),Events.addEvent("touchend",this._onTouchEnd,this.obj)))}},{key:"onSwipeLeft",value:function(t){this.onSwipeStart(t)}},{key:"onSwipeRight",value:function(t){this.onSwipeStart(t)}},{key:"onSwipeUp",value:function(t){this.onSwipeStart(t)}},{key:"onSwipeDown",value:function(t){this.onSwipeStart(t)}},{key:"onSwipeStart",value:function(t){this.swiping||(this.swiping=!0,this.startSwipeX=t.touches[0].pageX,this.startSwipeY=t.touches[0].pageY,this.addListener(TouchEvent.END,this.onSwipeEnd,this),this.addListener(TouchEvent.MOVE,this.onSwipeMove,this))}},{key:"onSwipeMove",value:function(t){this.swipeX=t.touches[0].pageX,this.swipeY=t.touches[0].pageY}},{key:"onSwipeEnd",value:function(t){this.swiping&&(this.swiping=!1,this.startSwipeX+this._swipeThreshold<this.swipeX&&this.dispatch(new TouchEvent(TouchEvent.SWIPE_RIGHT,this)),this.swipeX<this.startSwipeX-this._swipeThreshold&&this.dispatch(new TouchEvent(TouchEvent.SWIPE_LEFT,this)),this.startSwipeY+this._swipeThreshold<this.swipeY&&this.dispatch(new TouchEvent(TouchEvent.SWIPE_DOWN,this)),this.swipeY<this.startSwipeY-this._swipeThreshold&&this.dispatch(new TouchEvent(TouchEvent.SWIPE_UP,this)),this.removeListener(TouchEvent.MOVE,this.onSwipeMove),this.removeListener(TouchEvent.END,this.onSwipeEnd))}},{key:"enableDrag",value:function(t){this._onDragStart||(this._onDragStart=this.onDragStart.bind(this)),this.addMouseDownListener(this._onDragStart),Events.enableMouseTracking(),t?this.dragBounds=t:t=null,this.addListener(TouchEvent.START,this.onDragStart,this)}},{key:"disableDrag",value:function(){this.removeMouseDownListener(this._onDragStart),Events.disableMouseTracking()}},{key:"addDragTarget",value:function(t){for(var e in this.dragTargets)if(this.dragTargets[e]==t)return;this.dragTargets.push(t)}},{key:"removeDragTarget",value:function(t){for(var e in this.dragTargets)this.dragTargets[e]==t&&(this.dragTargets[e]=null)}},{key:"resetDragTargets",value:function(){this.dragTargets=[]}},{key:"onMouseMove",value:function(t){this.mX==Window.mouseX&&this.mY==Window.mouseY||(this.mX=Window.mouseX,this.mY=Window.mouseY,this.mX>this.coordinates[0]&&this.mX<this.coordinates[0]+this.obj.offsetWidth&&this.mY>this.coordinates[1]&&this.mY<Window.getObjectYPos(this.obj)+this.obj.offsetHeight&&this.dispatch(new MouseEvent(MouseEvent.MOVE,this)))}},{key:"onDragStart",value:function(t){if(t.preventDefault(),t.touches?(this.dragX=t.touches[0].pageX,this.dragY=t.touches[0].pageY):(this.dragX=Events.mouseX,this.dragY=Events.mouseY),!this.dragging){this.dragTarget||(this.dragTarget=this.obj),this.dragTarget.obj&&(this.dragTarget=this.dragTarget.obj),this.dragging=!0,this.dragClone=this.dragTarget.cloneNode(!0),this.dragClone.draggable=!1,Utils.cloneStyle(this.dragTarget,this.dragClone);for(var e=0,n=0,i=this.dragTarget;i.parentNode;)i!=this.dragTarget&&(e-=i.scrollLeft,n-=i.scrollTop),i=i.parentNode;this.currentDragX=this.dragX-Window.getObjectXPos(this.dragTarget)-e,this.currentDragY=this.dragY-Window.getObjectYPos(this.dragTarget)-n,Body.addChild(this.dragClone),this.dragRectangle=new Rectangle(0,0,this.dragClone.offsetWidth,this.dragClone.offsetHeight),this.dispatch(new MouseEvent(MouseEvent.DRAG_START,this,this.dragClone)),this.positionDrag(this.dragX,this.dragY),this.dragClone.style.position="absolute",this.currentDragOver=null,this._onDragEnd||(this._onDragEnd=this.onDragEnd.bind(this)),document.onmouseup=this._onDragEnd,this.addListener(TouchEvent.MOVE,this.onDragTouchMove,this),this.addListener(TouchEvent.END,this.onDragEnd,this),Window.addListener(MouseEvent.MOVE,this.onDrag,this)}}},{key:"onDragTouchMove",value:function(t){this.positionDrag(t.touches[0].pageX,t.touches[0].pageY)}},{key:"onDrag",value:function(t){this.positionDrag(Window.mouseX,Window.mouseY)}},{key:"positionDrag",value:function(t,e){if(this.dragX=t,this.dragY=e,this.dragging){var n;for(var i in this.dragRectangle.x=this.dragX-this.currentDragX,this.dragRectangle.y=this.dragY-this.currentDragY,this.dragBounds&&this.dragRectangle.constrain(this.dragBounds),this.dragClone&&this.dragClone.style&&(this.dragClone.style.top=this.dragRectangle.y+"px",this.dragClone.style.left=this.dragRectangle.x+"px"),Window.deSelectAll(),this.currentDragOver&&!dragImpact(this.currentDragOver)&&(this.dispatch(new MouseEvent(MouseEvent.DRAG_OUT,this,this.currentDragOver)),this.currentDragOver.dragTargetOut&&this.currentDragOver.dragTargetOut(this),this.currentDragOver=null),this.dragTargets)(n=dragImpact(this.dragTargets[i]))&&n!=this.currentDragOver&&(this.dispatch(new MouseEvent(MouseEvent.DRAG_OVER,this,n)),this.currentDragOver=n,this.dragTargets[i].dragTargetOver&&this.dragTargets[i].dragTargetOver(this));this.dispatch(new MouseEvent(MouseEvent.DRAG_MOVE,this,this.dragRectangle))}}},{key:"onDragEnd",value:function(t){var e;for(var n in this.dragTargets)if(e=dragImpact(this.dragTargets[n])){this.dispatch(new MouseEvent(MouseEvent.DRAG_DROP,this,e)),this.dragTargets[n].dragTargetDrop&&this.dragTargets[n].dragTargetDrop(this);break}Body.removeChild(this.dragClone),this.dragClone=null,document.onmouseup=null,Events.removeInterval(this.dragTick),this.dispatch(new MouseEvent(MouseEvent.DRAG_END,this)),this.dragging=!1,Window.removeListener(MouseEvent.MOVE,this.onDrag),this.removeListener(TouchEvent.MOVE,this.onDragTouchMove),this.removeListener(TouchEvent.END,this.onDragEnd)}},{key:"dragTargetDrop",value:function(t){this.dispatch(new MouseEvent(MouseEvent.DRAGGED_DROP,this,t))}},{key:"dragTargetOver",value:function(t){this.dispatch(new MouseEvent(MouseEvent.DRAGGED_OVER,this,t))}},{key:"dragTargetOut",value:function(t){this.dispatch(new MouseEvent(MouseEvent.DRAGGED_OUT,this,t))}},{key:"dropMouse",value:function(t,e,n){this._dropMouse=t}},{key:"dragImpact",value:function(t){if(t){t.get&&(t=t.get());var e,n,i,s,o=Window.getObjectXPos(t),r=Window.getObjectYPos(t),a=t.offsetWidth,h=t.offsetHeight;if(this._dropMouse?(e=this.dragX,n=this.dragY,i=1,s=1):(e=Window.getObjectXPos(this.dragClone),n=Window.getObjectYPos(this.dragClone),i=this.dragClone.offsetWidth,s=this.dragClone.offsetHeight),e+i>o&&e<o+a&&n+s>r&&n<r+h)for(var u in this.dragTargets){if(t==this.dragTargets[u])return this.dragTargets[u];if(this.dragTargets[u].get&&this.dragTargets[u].get()==t)return this.dragTargets[u]}}return!1}},{key:"onTouchMove",value:function(t){this.dispatch(new TouchEvent(TouchEvent.MOVE,this,t.touches)),t.preventDefault()}},{key:"onTouchStart",value:function(t){this.dispatch(new TouchEvent(TouchEvent.START,this,t.touches)),t.preventDefault()}},{key:"onTouchEnd",value:function(t){this.dispatch(new TouchEvent(TouchEvent.END,this,t.touches)),t.preventDefault()}},{key:"onMouseUp",value:function(t){this.suppressNativeMouse&&t.preventDefault(),this.dispatch(new MouseEvent(MouseEvent.UP,this))}},{key:"onTransitionComplete",value:function(t){this.dispatch(new TransitionEvent(TransitionEvent.COMPLETE,this))}},{key:"onTransitionBegin",value:function(t){this.dispatch(new TransitionEvent(TransitionEvent.BEGIN,this))}},{key:"onMouseDown",value:function(t){this.suppressNativeMouse&&t.preventDefault(),this.dispatch(new MouseEvent(MouseEvent.DOWN,this))}},{key:"onMouseClick",value:function(t){this.suppressNativeMouse&&t.preventDefault(),this.clickEnabled&&(this.dispatch(new MouseEvent(MouseEvent.CLICK,this)),this.clickEnabled=!1,setTimeout(this.onClickEnable.bind(this),this.clickDelay))}},{key:"onClickEnable",value:function(t){this.clickEnabled=!0}},{key:"onFileOver",value:function(t){t.preventDefault(),this.dispatch(new FileEvent(FileEvent.OVER,t.target.files||t.dataTransfer.files))}},{key:"onFileOut",value:function(t){t.preventDefault(),this.dispatch(new FileEvent(FileEvent.OUT,t.target.files||t.dataTransfer.files))}},{key:"onFileDrop",value:function(t){t.preventDefault(),this.dispatch(new FileEvent(FileEvent.DROP,t.target.files||t.dataTransfer.files))}},{key:"onFileDropOverProxy",value:function(t){t.preventDefault()}},{key:"onMouseOver",value:function(t){this.suppressNativeMouse&&t.preventDefault(),this.dispatch(new MouseEvent(MouseEvent.OVER,this))}},{key:"onMouseOut",value:function(t){this.suppressNativeMouse&&t.preventDefault(),this.dispatch(new MouseEvent(MouseEvent.OUT,this))}},{key:"onScroll",value:function(t){this.dispatch(new MouseEvent(DOMEvent.SCROLL,this))}},{key:"onRightClick",value:function(t){if(3==t.which||2==t.button)return this.dispatch(new MouseEvent(MouseEvent.RIGHT_CLICK,this)),t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}},{key:"onWheel",value:function(t){t.preventDefault();for(var e=document.querySelectorAll(":hover"),n=e.length-1;n>-1;n--)if(Element.wheelIndex.indexOf(e[n])>-1){if(e[n]==this.obj){var i=0,s=0,o=0;return null!=t.deltaY?(o=t.deltaY/40*-1,t.deltaX&&(s=t.deltaX)):null!=t.wheelDelta?o=t.wheelDelta/120:null!=t.detail&&(o=-1*t.detail),o>=1?i=1:o<=-1&&(i=-1),void this.dispatch(new MouseEvent(MouseEvent.WHEEL,this,i,s,o))}return}}},{key:"removeListener",value:function(t,n){_get(_getPrototypeOf(e.prototype),"removeListener",this).call(this,t,n),this.listenerLibrary[t]&&0==this.listenerLibrary[t].length&&(t==MouseEvent.UP&&this.removeMouseUpListener(this._onMouseUp),t==TransitionEvent.COMPLETE&&this.removeTransitionListener(this._onTransitionComplete),t==TransitionEvent.BEGIN&&this.removeTransitionStartListener(this._onTransitionBegin),t==MouseEvent.DOWN&&this.removeMouseDownListener(this._onMouseDown),t==MouseEvent.CLICK&&this.removeClickListener(this._onMouseClick),t==MouseEvent.OVER&&this.removeMouseOverListener(this._onMouseOver),t==MouseEvent.OUT&&this.removeMouseOutListener(this._onMouseOut),t==FileEvent.OVER&&this.removeFileOverListener(this._onFileOver),t==FileEvent.OUT&&this.removeFileOutListener(this._onFileOut),t==FileEvent.DROP&&this.removeFileDropListener(this._onFileDrop),t==MouseEvent.RIGHT_CLICK&&this.removeRightClickListener(this._onRightClick),t==MouseEvent.WHEEL&&(this.removeRightClickListener(this._onWheel),e.wheelIndex.splice(e.wheelIndex.indexOf(this.obj),1)),t==MouseEvent.MOVE&&(Events.removeInterval(this.mouseMove),Events.disableMouseTracking()),t==DOMEvent.SCROLL&&this.removeScrollListener(this._onRightClick),t==TouchEvent.MOVE&&Events.removeEvent("touchmove",this._onTouchMove,this.obj),t==TouchEvent.START&&Events.removeEvent("touchstart",this._onTouchStart,this.obj),t==TouchEvent.END&&Events.removeEvent("touchend",this._onTouchEnd,this.obj),t==TouchEvent.SWIPE_LEFT&&this.removeListener(TouchEvent.START,this._onSwipeLeft),t==TouchEvent.SWIPE_RIGHT&&this.removeListener(TouchEvent.START,this._onSwipeRight),t==TouchEvent.SWIPE_UP&&this.removeListener(TouchEvent.START,this._onSwipeUp),t==TouchEvent.SWIPE_DOWN&&this.removeListener(TouchEvent.START,this._onSwipeDown))}},{key:"applyTransforms",value:function(){var t="";this._rotation&&(t+="rotate("+this._rotation+"deg)"),this._scaleX&&(t+="scaleX("+this._scaleX+")"),this._scaleY&&(t+="scaleY("+this._scaleY+")"),this._skewX&&(t+="skewX("+this._skewX+"deg)"),this._skewY&&(t+="skewY("+this._skewY+"deg)"),this.style.transform=t,this.style.webkitTransform=t,this.style.mozTransform=t}},{key:"obj",set:function(t){t._obj=this,this._obj=t},get:function(){return this._obj}},{key:"scrollBar",get:function(){return this.obj.scrollHeight>this.obj.clientHeight}},{key:"style",get:function(){return this.obj.style}},{key:"text",set:function(t){this.obj.innerHTML=t},get:function(){return this.obj.innerHTML}},{key:"id",set:function(t){this.obj.id=t},get:function(){return this.obj.id}},{key:"name",set:function(t){this.obj.name=t},get:function(){return this.obj.name}},{key:"opacity",set:function(t){this._opacity=t,this.obj.style.opacity=t},get:function(){return this._opacity}},{key:"title",set:function(t){this.obj.title=t},get:function(){return this.obj.title}},{key:"wipeThreshold",set:function(t){this._swipeThreshold=t}},{key:"swipeThreshold",get:function(){return this._swipeThreshold}},{key:"drag",set:function(t){this._drag=t,t.get?this.dragTarget=t.get():this.dragTarget=t},get:function(){return this._drag}},{key:"tabIndex",set:function(t){this._tabIndex=t,this.obj.tabIndex=t},get:function(){return this._tabIndex}},{key:"width",set:function(t){this._width=t,this.obj.style.width=t+"px"},get:function(){return null==this._width&&(this._width=this.obj.offsetWidth),this._width}},{key:"height",set:function(t){this._height=t,this.obj.style.height=t+"px"},get:function(){return null==this._height&&(this._height=this.obj.offsetHeight),this._height}},{key:"dimensions",get:function(){var t=new Rectangle(Number(Utils.getStyle(this.obj,"left").replace(/\D/g,"")),Number(Utils.getStyle(this.obj,"top").replace(/\D/g,"")),this.obj.offsetWidth,this.obj.offsetHeight);return"border-box"==Utils.getStyle(this.obj,"-moz-box-sizing")||"border-box"==Utils.getStyle(this.obj,"-webkit-box-sizing")||"border-box"==Utils.getStyle(this.obj,"box-sizing")||(t.width-=Number(Utils.getStyle(this.obj,"padding-left").replace(/\D/g,""))+Number(Utils.getStyle(this.obj,"padding-right").replace(/\D/g,"")),t.height-=Number(Utils.getStyle(this.obj,"padding-top").replace(/\D/g,""))+Number(Utils.getStyle(this.obj,"padding-bottom").replace(/\D/g,"")),t.width-=Number(Utils.getStyle(this.obj,"border-left-width").replace(/\D/g,""))+Number(Utils.getStyle(this.obj,"border-right-width").replace(/\D/g,"")),t.height-=Number(Utils.getStyle(this.obj,"border-top-width").replace(/\D/g,""))+Number(Utils.getStyle(this.obj,"border-bottom-width").replace(/\D/g,""))),t}},{key:"x",set:function(t){this._x=t,this.obj.style.left=t+"px"},get:function(){return null==this._x&&(this._x=this.dimensions.x),this._x}},{key:"y",set:function(t){this._y=t,this.obj.style.top=t+"px"},get:function(){return null==this._y&&(this._y=this.dimensions.y),this._y}},{key:"z",set:function(t){this.style.zIndex=this._z=t},get:function(){return this._z||(this._z=Number(Utils.getStyle(this.obj,"z-index"))),this._z}},{key:"rotation",set:function(t){this._rotation=t,this.applyTransforms()},get:function(){return this._rotation}},{key:"scaleX",set:function(t){this._scaleX=t,this.applyTransforms()},get:function(){return this._scaleX}},{key:"scaleY",set:function(t){this._scaleY=t,this.applyTransforms()},get:function(){return this._scaleY}},{key:"skewY",set:function(t){this._skewY=t,this.applyTransforms()},get:function(){return this._skewY}},{key:"skewX",set:function(t){this._skewX=t,this.applyTransforms()},get:function(){return this._skewX}},{key:"coordinates",get:function(){var t=this.obj.getBoundingClientRect();return new Rectangle(t.left,t.top,t.width,t.height)}}]),e}(),Tag=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make(t),n}return _inherits(e,Base),e}(),Div=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("div"),t}return _inherits(e,Base),e}(),BodyClass=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("div"),Window.addListener(WindowEvent.LOAD,t.detect,_assertThisInitialized(t)),t}return _inherits(e,Base),_createClass(e,[{key:"detect",value:function(){var t=this.obj;try{this.obj=document.getElementsByTagName("BODY")[0]}catch(t){console.warn("Your document has no body tag. This means the Body class will NOT work.")}var e=new Array;for(var n in t.children)n>=0&&e.push(t.children[n]);for(n in e)this.obj.appendChild(e[n])}}]),e}(),Body=new BodyClass,InputObject=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,Base),_createClass(e,[{key:"addListener",value:function(t,n,i){_get(_getPrototypeOf(e.prototype),"addListener",this).call(this,t,n,i),1==this.listenerLibrary[t].length&&(t==InputEvent.CHANGE&&(this._onChange||(this._onChange=this.onChange.bind(this)),this.obj.onchange=this.obj.oninput=this._onChange,this.obj.onkeyup||(this.obj.onkeyup=this._onChange)),t==InputEvent.FOCUS&&(this._onFocus||(this._onFocus=this.onFocus.bind(this)),this.obj.onfocus=this._onFocus),t==InputEvent.BLUR&&(this._onBlur||(this._onBlur=this.onBlur.bind(this)),this.obj.onblur=this._onBlur),t==InputEvent.KEY_DOWN&&(this._onKeyDown||(this._onKeyDown=this.onKeyDown.bind(this)),this.obj.onkeydown=this._onKeyDown),t==InputEvent.KEY_UP&&(this._onKeyUp||(this._onKeyUp=this.onKeyUp.bind(this)),this.obj.onkeyup=this._onKeyUp))}},{key:"removeListener",value:function(t,n){_get(_getPrototypeOf(e.prototype),"removeListener",this).call(this,t,n),0==this.listenerLibrary[t].length&&t==InputEvent.CHANGE&&(this.obj.onchange=this.obj.oninput=null,this.obj.onkeyup==this._onChange&&(this.obj.onkeyup=null),t==InputEvent.FOCUS&&(this.obj.onfocus=null),t==InputEvent.BLUR&&(this.obj.onblur=null),t==InputEvent.KEY_DOWN&&(this.obj.onkeydown=null),t==InputEvent.KEY_UP&&(this.obj.onkeyup=null))}},{key:"onChange",value:function(t){this.dispatch(new InputEvent(InputEvent.CHANGE))}},{key:"onFocus",value:function(t){this.dispatch(new InputEvent(InputEvent.FOCUS))}},{key:"onBlur",value:function(t){this.dispatch(new InputEvent(InputEvent.BLUR))}},{key:"onKeyDown",value:function(t){this.dispatch(new InputEvent(InputEvent.KEY_DOWN))}},{key:"onKeyUp",value:function(t){this.dispatch(new InputEvent(InputEvent.CHANGE)),this.dispatch(new InputEvent(InputEvent.KEY_UP))}}]),e}(),Anchor=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("a"),t}return _inherits(e,Base),_createClass(e,[{key:"onClick",value:function(t){var e=Conductor.parseUrl(this.href);Conductor.launch(e.path,e.query,e.hash)}},{key:"href",set:function(t){this.obj.href=t;var e="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(Conductor.pushStateRoot?"/"+Conductor.pushStateRoot:"");Conductor.pushState&&-1!==this.obj.href.search(e)&&(this.suppressNativeMouse=!0,this.addListener(MouseEvent.CLICK,this.onClick,this))},get:function(){return this.obj.href}},{key:"target",set:function(t){this.obj.target=t},get:function(){return this.obj.target}}]),e}(),HeadClass=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("div"),Window.addListener(WindowEvent.LOAD,t.detect,_assertThisInitialized(t)),t}return _inherits(e,Base),_createClass(e,[{key:"detect",value:function(){var t=this.obj;try{this.obj=document.getElementsByTagName("HEAD")[0]}catch(t){console.warn("Your document has no head tag. This means the Head class will NOT work.")}var e=new Array;for(var n in t.children)n>=0&&e.push(t.children[n]);for(n in e)this.obj.appendChild(e[n])}}]),e}(),Head=new HeadClass,Form=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("Form"),t.obj.enctype="multipart/form-data",t}return _inherits(e,Base),_createClass(e,[{key:"submit",value:function(){this.obj.submit()}},{key:"method",set:function(t){this.obj.method=t},get:function(){return this.obj.method}},{key:"target",set:function(t){this.obj.target=t},get:function(){return this.obj.target}},{key:"action",set:function(t){this.obj.action=t},get:function(){return this.obj.action}}]),e}(),Upload=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("input"),t.obj.type="file",t}return _inherits(e,Base),e}(),Embed=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("embed"),t}return _inherits(e,Base),_createClass(e,[{key:"src",set:function(t){this.obj.src=t},get:function(){return this.obj.src}},{key:"hidden",set:function(t){this.obj.hidden=t},get:function(){return this.obj.hidden}},{key:"autoStart",set:function(t){this.obj.autoStart=t},get:function(){return this.obj.autoStart}},{key:"loop",set:function(t){this.obj.loop=t},get:function(){return this.obj.loop}}]),e}(),Header=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("h"+t),n}return _inherits(e,Base),e}(),IFrame=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("iframe"),t.obj.noresize="true",t.obj.frameBorder="0",t.obj.scrolling="no",t._width,t._height,t._src,t}return _inherits(e,Base),_createClass(e,[{key:"getSource",value:function(){return this.obj.contentDocument?this.obj.contentDocument:this.obj.contentWindow.document}},{key:"hide",value:function(){this.obj.style.display="none"}},{key:"width",set:function(t){this.obj.width=this._width=t},get:function(){return this._width}},{key:"height",set:function(t){this.obj.height=this._height=t},get:function(){return this._height}},{key:"src",set:function(t){this.obj.src=_src=t},get:function(){return _src}}]),e}(),Img=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("img"),t}return _inherits(e,Base),_createClass(e,[{key:"onLoad",value:function(t){this.removeListener(Event.LOAD,this.onLoad),this.obj.src=this._src.src}},{key:"src",set:function(t){"ImageLoader"===t.constructor.name?(this._src=t,t.loaded?this.onLoad(null):t.addListener(Event.LOAD,this.onLoad,this)):this._src=this.obj.src=t},get:function(){return this._src}},{key:"alt",set:function(t){this.obj.alt=t},get:function(){return this.obj.alt}}]),e}(),Label=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("label"),t}return _inherits(e,Base),e}(),ListItem=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("li"),t}return _inherits(e,Base),e}(),Paragraph=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("p"),t}return _inherits(e,Base),e}(),Password=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("input"),t.obj.type="password",t}return _inherits(e,InputObject),_createClass(e,[{key:"value",set:function(t){this.obj.value=t},get:function(){return this.obj.value}}]),e}(),Span=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("span"),t}return _inherits(e,Base),e}(),Link=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("link"),t}return _inherits(e,Base),_createClass(e,[{key:"rel",set:function(t){this.obj.rel=t},get:function(){return this.obj.rel}},{key:"type",set:function(t){this.obj.type=t},get:function(){return this.obj.type}},{key:"href",set:function(t){this.obj.href=t},get:function(){return this.obj.href}}]),e}(),TextArea=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("textarea"),t._maxLength,t}return _inherits(e,InputObject),_createClass(e,[{key:"autoSize",value:function(t,e){for(var n=0,i=this.obj.value.split("\n"),s=0;s<i.length;s++)n+=1+Math.floor(i[s].length*t/e);this.obj.rows=n}},{key:"onCheckLength",value:function(t){return!(this.count()>=this._maxLength)}},{key:"restrictLength",value:function(t){this.obj.value.length>this._maxLength&&(this.obj.value=this.obj.value.substr(0,this._maxLength))}},{key:"value",set:function(t){this.obj.value=t},get:function(){return this.obj.value}},{key:"count",get:function(){for(var t=-1,e=this.obj.value.split("\n"),n=0;n<e.length;n++)t+=e[n].length,t++;return t}},{key:"maxLength",set:function(t){this._maxLength=t,this._restrictLength||(this._restrictLength=this.restrictLength.bind(this)),this.obj.onpaste=this._restrictLength,this.obj.onkeyup=this._restrictLength},get:function(){return this._maxLength}}]),e}(),Input=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("input"),t&&(n.obj.type=t),n}return _inherits(e,InputObject),_createClass(e,[{key:"value",set:function(t){this.obj.value=t},get:function(){return this.obj.value}},{key:"maxLength",set:function(t){this.obj.maxLength=t},get:function(){return this.obj.maxLength}}]),e}(),Checkbox=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("input"),t.obj.type="checkbox",t}return _inherits(e,InputObject),_createClass(e,[{key:"value",set:function(t){this.obj.checked=t},get:function(){return this.obj.checked}}]),e}(),RadioButton=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("input"),t.obj.type="radio",t}return _inherits(e,InputObject),_createClass(e,[{key:"value",set:function(t){this.obj.checked=t},get:function(){return this.obj.checked}},{key:"name",set:function(t){this.obj.name=t},get:function(){return this.obj.name}}]),e}(),Select=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("select"),t}return _inherits(e,InputObject),_createClass(e,[{key:"value",set:function(t){this.obj.value=t},get:function(){return this.obj.value}}]),e}(),Option=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("option"),t&&(n.text=t),n}return _inherits(e,Base),_createClass(e,[{key:"value",set:function(t){this.obj.value=t},get:function(){return this.obj.value}}]),e}(),UnorderedList=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("ul"),t}return _inherits(e,Base),e}(),OrderedList=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("ol"),t}return _inherits(e,Base),e}(),DefinitionList=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("dl"),t}return _inherits(e,Base),e}(),DefinitionTerm=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("dt"),t}return _inherits(e,Base),e}(),DefinitionDefine=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("dd"),t}return _inherits(e,Base),e}(),Article=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("article"),t}return _inherits(e,Base),e}(),Aside=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("aside"),t}return _inherits(e,Base),e}(),Details=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("details"),t}return _inherits(e,Base),e}(),Footer=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("footer"),t}return _inherits(e,Base),e}(),Nav=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("nav"),t}return _inherits(e,Base),e}(),Output=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("output"),t}return _inherits(e,Base),e}(),Progress=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("progress"),t}return _inherits(e,Base),e}(),Section=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("section"),t}return _inherits(e,Base),e}(),Source=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("source"),t}return _inherits(e,Base),e}(),Summary=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("summary"),t}return _inherits(e,Base),e}(),Code=function(t){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).make("code"),t}return _inherits(e,Base),e}(),Template=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)))._state=new Model,n._state.addListener(Event.CHANGE,n.render,_assertThisInitialized(n)),n.set(t||{}),n}return _inherits(e,Div),_createClass(e,[{key:"set",value:function(t){this._state.update(t,!0)}},{key:"child",value:function(t){return Selector.get(t,this)}},{key:"render",value:function(){var t=this;return this.view&&(this.text=this.view()),this.wait(function(e){return t.dispatch(new Event(Event.CHANGE,t))}),this.text}},{key:"state",get:function(){return this._state.data}}]),e}(),Router=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).routes=t||[],n.currentView=null,n.currentUrl=null,n}return _inherits(e,EventDispatcher),_createClass(e,[{key:"enable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Conductor.addListener(ConductorEvent.LAUNCH,this.onLaunch,this),Conductor.enable(!0,t)}},{key:"onLaunch",value:function(t){this.currentUrl=t.params,0===t.params.length&&(t.params=[""]);for(var e=0;e<this.routes.length;e++){var n=this.routes[e].path.split("/");if(this.routes[e].path===t.params.slice(0,n.length).join("/")&&t.params.length>=this.routes[e].depth[0]&&t.params.length<=this.routes[e].depth[1])return this.currentView&&this.currentView.shutDown(),this.currentView=new this.routes[e].view(t.params),Body.addChild(this.currentView),void this.dispatch(new RouterEvent(RouterEvent.PAGE_CHANGE,this))}""===t.params[0]?this.dispatch(new RouterEvent(RouterEvent.DEFAULT,this)):this.dispatch(new RouterEvent(RouterEvent.NOT_FOUND,this))}}]),e}(),ConductorClass=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,EventDispatcher),_createClass(e,[{key:"enable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentUrl=null,this.pushState=t,this.pushState?(this.pushStateRoot=e,window.onpopstate=this.onPopState.bind(this),Window.removeListener(WindowEvent.PULSE,this.checkUrl),this.onPopState()):(this.current=null,this.stream=null,Window.addListener(WindowEvent.PULSE,this.checkUrl,this),window.onpopstate=null,this.checkUrl())}},{key:"onPopState",value:function(t){var e=this.parseUrl(window.location.href);this.launch(e.path,e.query,e.hash)}},{key:"parseUrl",value:function(t){var e=(t=t.split("?"))[0],n=null,i=null;return t[1]?(n=(t=t[1].split("#"))[1],i=t[0]):(e=(t=t[0].split("#"))[0],n=t[1]||null),(e=(e=this.pushStateRoot?e.split(this.pushStateRoot)[1]:e.split(window.location.hostname)[1]).split("/")).shift(),1===e.length&&""===e[0]&&(e=[]),{path:e,hash:n,query:i}}},{key:"launch",value:function(t,e,n,i){var s="".concat(t.join("/")).concat(e?"?":"").concat(Utils.encodeQuery(e)).concat(n?"#":"").concat(n||"");this.currentUrl===s&&this.pushState||(this.currentUrl=s,this.currentUrlData=_defineProperty({params:t,query:e,hash:n,noLaunch:i},"noLaunch",i),this.launchPage(t,e,n,i))}},{key:"refresh",value:function(){this.launchPage(this.currentUrlData.params,this.currentUrlData.query,this.currentUrlData.hash,this.currentUrlData.noLaunch)}},{key:"launchPage",value:function(t,e,n,i){var s;t?s=new ConductorEvent(i?ConductorEvent.NO_LAUNCH:ConductorEvent.LAUNCH,t[0],t,e,n):(t=new Array,s=new ConductorEvent(ConductorEvent.DEFAULT,"",t)),this.displayNewUrl(s),this.dispatch(s)}},{key:"launchUrl",value:function(){if(window.location.hash){var t=window.location.hash.split("/");t.shift(),t[0]=t[0].replace("#!","");t[0];this.launchPage(t)}else this.launchPage("")}},{key:"displayNewUrl",value:function(t){if(this.pushState){var e=t.params.join("/");this.pushStateRoot&&(e=this.pushStateRoot+"/"+e),(e="/"+e)!==window.location.pathname&&(t.query&&(e+="?"+t.query),t.hash&&(e+="#"+t.hash),history.pushState({},null,e))}else{for(var n="",i=!0,s=0;s<t.params.length;s++)i&&(n+="#!",i=!1),""!=t.params[s]&&(n+="/"+t.params[s]);""!=n&&"#!"!=n&&(window.location.hash=n),this.current=window.location.hash}}},{key:"setCanonical",value:function(t,e){for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++)if("canonical"==n[i].rel)var s=n[i];s||((s=document.createElement("link")).rel="canonical",Head.addChild(s));var o="/",r=!0;for(i=0;i<e;i++)r&&(o+="#!",r=!1),o+="/"+t.params[i];s.href=o}},{key:"checkUrl",value:function(){window.location.hash!=this.current&&this.launchUrl()}}]),e}(),Conductor=new ConductorClass;